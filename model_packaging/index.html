
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://slaclab.github.io/lume-services/model_packaging/">
      
      
        <link rel="prev" href="../demo/">
      
      
        <link rel="next" href="../services/files/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.41">
    
    
      
        <title>Model Packaging - lume-services</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#model-packaging-wip-docs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="lume-services" class="md-header__button md-logo" aria-label="lume-services" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            lume-services
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Model Packaging
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/slaclab/lume-services" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href=".." class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Model Packaging

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../services/files/" class="md-tabs__link">
          
  
  Services

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/tasks/" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../developer/setup/" class="md-tabs__link">
          
  
  Developer

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="lume-services" class="md-nav__button md-logo" aria-label="lume-services" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    lume-services
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/slaclab/lume-services" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LUME-Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Model Packaging
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Model Packaging
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-package" class="md-nav__link">
    <span class="md-ellipsis">
      Python Package
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python Package">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-a-repository-for-your-project-on-github" class="md-nav__link">
    <span class="md-ellipsis">
      1. Create a repository for your project on GitHub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-compile-a-yaml-for-your-model-input-output-variables" class="md-nav__link">
    <span class="md-ellipsis">
      2. Compile a YAML for your model input + output variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-create-project-using-template" class="md-nav__link">
    <span class="md-ellipsis">
      2: Create project using template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-generated-repo-to-use-github-repo-as-the-origin" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configure generated repo to use GitHub repo as the origin:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-set-up-model" class="md-nav__link">
    <span class="md-ellipsis">
      4. Set up model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-set-up-flow" class="md-nav__link">
    <span class="md-ellipsis">
      5. Set up flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-create-development-environment" class="md-nav__link">
    <span class="md-ellipsis">
      6. Create development environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      7. GitHub actions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registries" class="md-nav__link">
    <span class="md-ellipsis">
      Registries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Registries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stanford-container-registry" class="md-nav__link">
    <span class="md-ellipsis">
      Stanford Container Registry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerhub" class="md-nav__link">
    <span class="md-ellipsis">
      DockerHub
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Model Packaging
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Model Packaging
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#variables" class="md-nav__link">
    <span class="md-ellipsis">
      Variables
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model" class="md-nav__link">
    <span class="md-ellipsis">
      Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-package" class="md-nav__link">
    <span class="md-ellipsis">
      Python Package
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Python Package">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-create-a-repository-for-your-project-on-github" class="md-nav__link">
    <span class="md-ellipsis">
      1. Create a repository for your project on GitHub
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-compile-a-yaml-for-your-model-input-output-variables" class="md-nav__link">
    <span class="md-ellipsis">
      2. Compile a YAML for your model input + output variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-create-project-using-template" class="md-nav__link">
    <span class="md-ellipsis">
      2: Create project using template
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configure-generated-repo-to-use-github-repo-as-the-origin" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configure generated repo to use GitHub repo as the origin:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-set-up-model" class="md-nav__link">
    <span class="md-ellipsis">
      4. Set up model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-set-up-flow" class="md-nav__link">
    <span class="md-ellipsis">
      5. Set up flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-create-development-environment" class="md-nav__link">
    <span class="md-ellipsis">
      6. Create development environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-github-actions" class="md-nav__link">
    <span class="md-ellipsis">
      7. GitHub actions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#registries" class="md-nav__link">
    <span class="md-ellipsis">
      Registries
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Registries">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stanford-container-registry" class="md-nav__link">
    <span class="md-ellipsis">
      Stanford Container Registry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dockerhub" class="md-nav__link">
    <span class="md-ellipsis">
      DockerHub
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results DB Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/hpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../services/scheduling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduling Service
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tasks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/files/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/files/serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/files/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_1" >
        
          
          <label class="md-nav__link" for="__nav_4_10_1" id="__nav_4_10_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Results
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10_1">
            <span class="md-nav__icon md-icon"></span>
            Results
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/results/results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results Database Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/results/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_2" >
        
          
          <label class="md-nav__link" for="__nav_4_10_2" id="__nav_4_10_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10_2">
            <span class="md-nav__icon md-icon"></span>
            Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/files/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/files/filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filesystems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_3" >
        
          
          <label class="md-nav__link" for="__nav_4_10_3" id="__nav_4_10_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10_3">
            <span class="md-nav__icon md-icon"></span>
            Model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/models/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Database Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/models/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_4" >
        
          
          <label class="md-nav__link" for="__nav_4_10_4" id="__nav_4_10_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Scheduling
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10_4">
            <span class="md-nav__icon md-icon"></span>
            Scheduling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/scheduling/scheduling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduling Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/services/scheduling/backends/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Backends
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Developer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer/setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer/documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer/todo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TODO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer/docker_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Image
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="model-packaging-wip-docs">Model packaging (WIP docs)</h1>
<p>The LUME project provides a standard interface for formatting models for use with LUME services in <a href="https://slaclab.github.io/lume-model/">LUME-model</a>. LUME-services relies on this interface for templating the user packages served over orchestration tooling. The formatting strategy consists of:</p>
<ol>
<li>Model variables</li>
<li>Model execution class</li>
</ol>
<h2 id="variables">Variables</h2>
<p><a href="https://slaclab.github.io/lume-model/variables/">LUME-model variables</a> define the inputs and outputs to the model and enforce minimal metadata on the variables. The variables are divided into categories, with <code>InputVariable</code> and <code>OutputVariable</code> as bases, then further subdivided by data.</p>
<p>Variables may be defined either programatically:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">lume_model.variables</span> <span class="kn">import</span> <span class="n">ScalarInputVariable</span><span class="p">,</span> <span class="n">ScalarOutputVariable</span>

<span class="n">input_variable</span> <span class="o">=</span> <span class="n">ScalarInputVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_input&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">value_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">output_variable</span> <span class="o">=</span> <span class="n">ScalarOutputVariable</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;test_output&quot;</span><span class="p">)</span>
</code></pre></div></p>
<p>Or using a YAML spec:</p>
<p><code>my_variables.yml</code>
<div class="highlight"><pre><span></span><code><span class="nt">input_variables</span><span class="p">:</span>
<span class="w">  </span><span class="nt">input1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input1</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scalar</span>
<span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">      </span><span class="nt">range</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">256</span><span class="p p-Indicator">]</span>

<span class="w">  </span><span class="nt">input2</span><span class="p">:</span>
<span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">input2</span>
<span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scalar</span>
<span class="w">      </span><span class="nt">default</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.0</span>
<span class="w">      </span><span class="nt">range</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">0</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">256</span><span class="p p-Indicator">]</span>

<span class="nt">output_variables</span><span class="p">:</span>
<span class="w">  </span><span class="nt">output1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output1</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">image</span>
<span class="w">    </span><span class="nt">x_label</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value1&quot;</span>
<span class="w">    </span><span class="nt">y_label</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value2&quot;</span>
<span class="w">    </span><span class="nt">axis_units</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;mm&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;mm&quot;</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">x_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">x_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">y_min</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="nt">y_max</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>

<span class="w">  </span><span class="nt">output2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output2</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scalar</span>

<span class="w">  </span><span class="nt">output3</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">output3</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">scalar</span>
</code></pre></div></p>
<p>And subsequently loaded using:
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">lume_model.utils</span> <span class="kn">import</span> <span class="n">variables_from_yaml</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;my_variables.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
  <span class="n">input_variables</span><span class="p">,</span> <span class="n">output_variables</span> <span class="o">=</span> <span class="n">variables_from_yaml</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="model">Model</h2>
<p>The LUME-model class provides a minimal and extensible base for formatting models. The ‘evaluate’ method must be implemented on the subclass and accept a dictionary mapping input variable name to LUME-model input variable. The output of the <code>evaluate</code> method will be the dictionary output. The example packaged in the <a href="../demo/">demo</a> implements the following:</p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lume_model.models</span> <span class="kn">import</span> <span class="n">BaseModel</span>
<span class="kn">from</span> <span class="nn">lume_model.variables</span> <span class="kn">import</span> <span class="n">InputVariable</span><span class="p">,</span> <span class="n">OutputVariable</span>
<span class="kn">from</span> <span class="nn">my_model</span> <span class="kn">import</span> <span class="n">INPUT_VARIABLES</span><span class="p">,</span> <span class="n">OUTPUT_VARIABLES</span>

<span class="k">class</span> <span class="nc">MyModel</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">):</span>
    <span class="n">input_variables</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">INPUT_VARIABLES</span><span class="p">)</span>
    <span class="n">output_variables</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">OUTPUT_VARIABLES</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">settings_kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the model. If additional settings are required, they can be</span>
<span class="sd">        passed and handled here. For models that are wrapping model loads</span>
<span class="sd">        from other frameworks, this can be used for loading weights, referencing</span>
<span class="sd">        data files, etc.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="c1"># handle settings if any</span>
        <span class="c1"># if settings_kwargs is not None:</span>
        <span class="c1"># ...</span>


    <span class="k">def</span> <span class="nf">evaluate</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">input_variables</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">InputVariable</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">OutputVariable</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;The evaluate method accepts input variables, performs the model execution,</span>
<span class="sd">        then returns a dictionary mapping variable name to output variable.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_variables (Dict[str, InputVariable]): Dictionary of LUME-model input</span>
<span class="sd">                variables with values assigned.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Dict[str, OutputVariable]: Dictionary of LUME-model output variables with</span>
<span class="sd">                values assigned.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span>
            <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>  <span class="c1"># lower dist bound</span>
            <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>  <span class="c1"># upper dist bound</span>
            <span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input1&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span><span class="p">[</span><span class="s2">&quot;output3&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">input_variables</span><span class="p">[</span><span class="s2">&quot;input2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>


        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_variables</span>
</code></pre></div>
<p>The class can be extended to absorb other methods, accept custom kwargs, etc.</p>
<h2 id="python-package">Python Package</h2>
<p>The <a href="https://github.com/slaclab/lume-services-model-template">LUME-services-model-template</a> provides a <a href="https://cookiecutter.readthedocs.io/en/stable/">cookiecutter</a>. The cookiecutter generates a LUME-services-compatible Python project with the following structure:</p>
<div class="highlight"><pre><span></span><code>&lt;your project&gt;
├── Dockerfile
├── MANIFEST.in
├── README.md
├── _entrypoint.sh
├── conftest.py
├── dev-environment.yml
├── environment.yml
├── &lt;package name&gt;
│   ├── __init__.py
│   ├── _image.py
│   ├── _version.py
│   ├── files
│   │   ├── __init__.py
│   │   └── variables.yml
│   ├── flow.py
│   ├── model.py
│   └── tests
│       ├── __init__.py
│       └── test_flow.py
├── pytest.ini
├── requirements.txt
├── setup.cfg
├── setup.py
└── versioneer.py
</code></pre></div>
<p>The following steps describe use of this template.</p>
<h3 id="1-create-a-repository-for-your-project-on-github">1. Create a repository for your project on GitHub</h3>
<p>Using your GitHub account, create an empty repository with your project name.</p>
<h3 id="2-compile-a-yaml-for-your-model-input-output-variables">2. Compile a YAML for your model input + output variables</h3>
<p>Create a YAML using the <a href="https://slaclab.github.io/lume-model/#variables">LUME-model variable spec</a>.</p>
<h3 id="2-create-project-using-template">2: Create project using template</h3>
<p>Clone <code>lume-services-model-template</code> and navigate to repository:
<div class="highlight"><pre><span></span><code>git clone https://github.com/slaclab/lume-services-model-template
cd lume-services-model-template
</code></pre></div></p>
<p>Create the template environment:</p>
<div class="highlight"><pre><span></span><code>conda env create -f environment.yml
conda activate lume-services-model-template
</code></pre></div>
<p>Create your project. The <code>-o</code> flag indicates the directory where you'd like the resulting repo to be stored. For now, let's create it in the repo root:
<div class="highlight"><pre><span></span><code>cookiecutter template -o $(pwd)
</code></pre></div></p>
<p>Answer the prompts
<div class="highlight"><pre><span></span><code>author: &lt;your name&gt;
email: &lt;your email address&gt;
github_username: &lt;your GitHub username&gt;
github_url: &lt;url of GitHub repo you&#39;ve just created&gt;
project_name: &lt;Name of GitHub repository&gt;
</code></pre></div>
You can use your own names below or use auto-generated values in the brackets by pressing enter.
<div class="highlight"><pre><span></span><code>repo_name [...]:
package [...]:
model_class [...]:
</code></pre></div></p>
<p>The template contains GitHub actions for building a Docker image from the package that will be used to run workflows in the distributed environment. If you plan to use the <a href="https://itcommunity.stanford.edu/unconference/sessions/2018/introducing-scr-stanford-container-registry">Stanford Container Registry</a> provided by the <a href="https://code.stanford.edu/SiteDocs/faq">code.stanford.edu</a> effort, enter <code>2</code>. Otherwise, enter <code>1</code> for DockerHub. See (model_packaging.md#registries) </p>
<p><div class="highlight"><pre><span></span><code>Select container_registry:
1 - DockerHub
2 - Stanford Container Registry
Choose from 1, 2 [1]:
</code></pre></div>
Now, enter the username you use for the contaner registry:</p>
<p><div class="highlight"><pre><span></span><code>container_username: &lt;your registry username&gt; 
</code></pre></div>
And the full path to your variable file compiled in #2. 
<div class="highlight"><pre><span></span><code>model_config_file: &lt;path/to/you/variable.yml&gt;
</code></pre></div></p>
<p>Now, navigate to the directory where you've created your repository:
<div class="highlight"><pre><span></span><code>cd &lt;your project name&gt;
</code></pre></div></p>
<h3 id="3-configure-generated-repo-to-use-github-repo-as-the-origin">3. Configure generated repo to use GitHub repo as the origin:</h3>
<p>Replace username and brackets in the below command:
<div class="highlight"><pre><span></span><code>git remote add origin git@github.com:&lt;your GitHub username&gt;/&lt;your project&gt;.git
git push --set-upstream -f origin main
</code></pre></div></p>
<p>Note: If your local git configuration defaults to creating a branch with name <code>master</code>, you'll have to rename the local branch to main using:
<div class="highlight"><pre><span></span><code>git branch -m master main
</code></pre></div></p>
<h3 id="4-set-up-model">4. Set up model</h3>
<p>You can now update your model to fit your needs provided that the <code>evaluate</code> method accepts a dictionary mapping input variable name to LUME-model input variable and the method returns a dictionary mapping variable name to LUME-model output variable.</p>
<p>Edit the environment.yml files in the repository to reflect the project dependencies. No additional dependencies will be downloaded for pip packages. This means all dependencies must be provided in the environment.yml of the project. </p>
<h3 id="5-set-up-flow">5. Set up flow</h3>
<p>In order for our flow to run, we must edit the code in <code>&lt;your project&gt;/flow.py</code>. The comments in the <code>flow.py</code> should serve as a guide to setting up the flow.</p>
<p>** Notes:</p>
<p>Prefect's parameters must be json serializable
Special datetime parameter uses <a href="https://pypi.org/project/pendulum/">pendulum</a> to <a href="https://github.com/PrefectHQ/prefect/blob/e6bd04abb5580eb79bde12b9ad3845e9f1d1479c/src/prefect/core/parameter.py#L147">parse datetime strings</a>
Pass datetimes as strings by calling <code>my_datetime.isoformat()</code></p>
<h3 id="6-create-development-environment">6. Create development environment</h3>
<p>Now, create an environment for working with your model package:</p>
<div class="highlight"><pre><span></span><code>conda env create -f dev-environment.yml
conda activate &lt;your-project&gt;-dev
</code></pre></div>
<p>Install your package into this environment:
<div class="highlight"><pre><span></span><code>pip install -e .
</code></pre></div></p>
<h3 id="7-github-actions">7. GitHub actions</h3>
<p>The template configures a number of actions to run against the repository once checked in to the GitHub origin. Statuses of these workflows will be available in our GitHub repository at <code>https://github.com/&lt;your GitHub username&gt;/&lt;your project&gt;/actions</code>. The testing workflow configured in <code>.github/workflows/tests.yml</code> will run automatically on pushes to your main branch and you can monitor the success of these tests from the GitHub actions console for the repo. The workflow tests your package against a matrix of Python versions (3.7, 3.8, 3.9) on the latest Ubuntu build. You can expand this matrix if desired using <a href="https://docs.github.com/en/actions/using-jobs/using-a-matrix-for-your-jobs">GitHub actions matrix options</a>.</p>
<p>Versioned tags of the GitHub repository will correspond to deployments of a given model. The build action runs once a tag is created and uploads the model to your registry service of choice. </p>
<h2 id="registries">Registries</h2>
<h3 id="stanford-container-registry">Stanford Container Registry</h3>
<p>SLAC users can take advantage of the <a href="https://itcommunity.stanford.edu/unconference/sessions/2018/introducing-scr-stanford-container-registry">Stanford Container Registry</a> to store their containers. The steps for configuring your project to use the registry are as follows:</p>
<ol>
<li>Create an API token at https://code.stanford.edu/-/profile/personal_access_tokens. For <code>Token name</code> enter <code>My Model</code>. Optionally choose an expiration date. This can be whatever you'd like, but the GitHub action secret defined in step 3. will need to be updated with a new value after this expiration. Record this API token for use in steps 9.3 and 9.4.</li>
</ol>
<p><img alt="token" src="../files/PAT.png" /></p>
<ol>
<li>Create a project using <a href="https://code.stanford.edu/projects/new#blank_project">Stanford Code</a>. In the <code>Project name</code> field, write <code>My Model</code>. Select internal visibility level.</li>
</ol>
<p><img alt="project" src="../files/scr_project.png" /></p>
<ol>
<li>Add the token to your GitHub repository secrets. Navigate to your repository settings. In the left sidebar, click <code>Secrets</code>, <code>Actions</code>, then <code>New repository secret</code>. Type <code>SCR_PAT</code> into the name, and your generated API key into the value. Repeat this process to set a secret named <code>STANFORD_USERNAME</code> to your Stanford username.</li>
</ol>
<h3 id="dockerhub">DockerHub</h3>
<p>In order to use DockerHub workflow, you must first create a <a href="https://hub.docker.com/">DockerHub account</a>, then set the appropriate <a href="https://docs.github.com/en/actions/security-guides/encrypted-secrets">GitHub secrets</a> on the repository.</p>
<ol>
<li>Navigate to the settings on your repository.  </li>
</ol>
<p><img alt="settings" src="../files/repo-actions-settings.png" /></p>
<ol>
<li>In the left sidebar, click <code>Secrets</code>, <code>Actions</code>, then <code>New repository secret</code>. Type <code>DOCKER_USERNAME</code> into the name, and your DockerHub username into the value and click <code>Add secret</code> to save. Repeat this process to create a <code>DOCKER_PASSWORD</code> secret with your DockerHub password as the value.  </li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["toc.integrate", "toc.follow", "navigation.top", "navigation.tabs"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>