
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://slaclab.github.io/lume-services/api/services/scheduling/backends/">
      
      
        <link rel="prev" href="../scheduling/">
      
      
        <link rel="next" href="../../../../developer/setup/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.41">
    
    
      
        <title>Backends - lume-services</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#lume_services.services.scheduling.backends.backend" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="lume-services" class="md-header__button md-logo" aria-label="lume-services" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            lume-services
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Backends
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/slaclab/lume-services" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../.." class="md-tabs__link">
          
  
  Overview

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../model_packaging/" class="md-tabs__link">
        
  
    
  
  Model Packaging

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../services/files/" class="md-tabs__link">
          
  
  Services

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../tasks/" class="md-tabs__link">
          
  
  API

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../developer/setup/" class="md-tabs__link">
          
  
  Developer

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="lume-services" class="md-nav__button md-logo" aria-label="lume-services" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    lume-services
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/slaclab/lume-services" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Overview
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LUME-Services
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../model_packaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Packaging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../demo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Demo
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../model_packaging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Packaging
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../services/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../services/results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results DB Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../services/hpc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HPC Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../services/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Modeling Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../services/scheduling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduling Service
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tasks
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Tasks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tasks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tasks
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../files/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../files/serializers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Serializers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../files/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../errors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Errors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../flows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" checked>
        
          
          <label class="md-nav__link" for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Services
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_1" >
        
          
          <label class="md-nav__link" for="__nav_4_10_1" id="__nav_4_10_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Results
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10_1">
            <span class="md-nav__icon md-icon"></span>
            Results
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../results/results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Results Database Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../results/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_2" >
        
          
          <label class="md-nav__link" for="__nav_4_10_2" id="__nav_4_10_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Files
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10_2">
            <span class="md-nav__icon md-icon"></span>
            Files
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../files/files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    File Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../files/filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filesystems
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_3" >
        
          
          <label class="md-nav__link" for="__nav_4_10_3" id="__nav_4_10_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Model
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10_3">
            <span class="md-nav__icon md-icon"></span>
            Model
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model Database Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../models/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Database
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_10_4" id="__nav_4_10_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Scheduling
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_10_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_10_4">
            <span class="md-nav__icon md-icon"></span>
            Scheduling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../scheduling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduling Service
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Backends
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Backends
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend" class="md-nav__link">
    <span class="md-ellipsis">
      backend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.Backend" class="md-nav__link">
    <span class="md-ellipsis">
      Backend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Backend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.Backend.create_project" class="md-nav__link">
    <span class="md-ellipsis">
      create_project
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.Backend.load_flow" class="md-nav__link">
    <span class="md-ellipsis">
      load_flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.Backend.register_flow" class="md-nav__link">
    <span class="md-ellipsis">
      register_flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.Backend.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.Backend.run_and_return" class="md-nav__link">
    <span class="md-ellipsis">
      run_and_return
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.RunConfig" class="md-nav__link">
    <span class="md-ellipsis">
      RunConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RunConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.backend.RunConfig.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local" class="md-nav__link">
    <span class="md-ellipsis">
      local
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalBackend" class="md-nav__link">
    <span class="md-ellipsis">
      LocalBackend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LocalBackend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalBackend.create_project" class="md-nav__link">
    <span class="md-ellipsis">
      create_project
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalBackend.load_flow" class="md-nav__link">
    <span class="md-ellipsis">
      load_flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalBackend.register_flow" class="md-nav__link">
    <span class="md-ellipsis">
      register_flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalBackend.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalBackend.run_and_return" class="md-nav__link">
    <span class="md-ellipsis">
      run_and_return
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalRunConfig" class="md-nav__link">
    <span class="md-ellipsis">
      LocalRunConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="LocalRunConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalRunConfig.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.local.LocalRunConfig.validate" class="md-nav__link">
    <span class="md-ellipsis">
      validate
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server" class="md-nav__link">
    <span class="md-ellipsis">
      server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server.ServerBackend" class="md-nav__link">
    <span class="md-ellipsis">
      ServerBackend
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ServerBackend">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server.ServerBackend.create_project" class="md-nav__link">
    <span class="md-ellipsis">
      create_project
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server.ServerBackend.load_flow" class="md-nav__link">
    <span class="md-ellipsis">
      load_flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server.ServerBackend.register_flow" class="md-nav__link">
    <span class="md-ellipsis">
      register_flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server.ServerBackend.run" class="md-nav__link">
    <span class="md-ellipsis">
      run
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server.ServerBackend.run_and_return" class="md-nav__link">
    <span class="md-ellipsis">
      run_and_return
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.server.ServerBackend.run_config_type" class="md-nav__link">
    <span class="md-ellipsis">
      run_config_type
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.docker" class="md-nav__link">
    <span class="md-ellipsis">
      docker
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.docker.DockerBackend" class="md-nav__link">
    <span class="md-ellipsis">
      DockerBackend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.docker.DockerRunConfig" class="md-nav__link">
    <span class="md-ellipsis">
      DockerRunConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DockerRunConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.docker.DockerRunConfig.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.docker.DockerRunConfig.validate_host_config" class="md-nav__link">
    <span class="md-ellipsis">
      validate_host_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      kubernetes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.kubernetes.KubernetesBackend" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesBackend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig" class="md-nav__link">
    <span class="md-ellipsis">
      KubernetesRunConfig
    </span>
  </a>
  
    <nav class="md-nav" aria-label="KubernetesRunConfig">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.build" class="md-nav__link">
    <span class="md-ellipsis">
      build
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.validate_memory" class="md-nav__link">
    <span class="md-ellipsis">
      validate_memory
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Developer
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Developer
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer/setup/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setup
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer/documentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer/todo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    TODO
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cluster Architecture
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer/configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../developer/docker_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Image
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>Backends</h1>

<div class="doc doc-object doc-module">



<a id="lume_services.services.scheduling.backends.backend"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.backend.Backend" class="doc doc-heading">
            <code>Backend</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>BaseModel</code>, <code>ABC</code></p>


        <p>Abstract base class for Prefect backends. Backends handle Prefect interactions
including running of flows, result handling, and flow registration with server
backends.</p>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Backend</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract base class for Prefect backends. Backends handle Prefect interactions</span>
<span class="sd">    including running of flows, result handling, and flow registration with server</span>
<span class="sd">    backends.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">create_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Prefect project. Backend implementations without server connecton</span>
<span class="sd">        should raise errors when this method is called.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_name (str): Create a named Prefect project.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">register_flow</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
        <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a flow with Prefect. Backend implementations without server connecton</span>
<span class="sd">        should raise errors when this method is called.</span>

<span class="sd">        Args:</span>
<span class="sd">            flow (Flow): Prefect flow to register.</span>
<span class="sd">            project_name (str): Name of project to register flow to.</span>
<span class="sd">            image (str): Name of Docker image to run flow inside.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: ID of registered flow.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">load_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flow_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Prefect flow object. Backend implementations without server connecton</span>
<span class="sd">        should raise errors when this method is called.</span>

<span class="sd">        Args:</span>
<span class="sd">            flow_name (str): Name of flow.</span>
<span class="sd">            project_name (str): Name of project flow is registered with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dictionary with keys &quot;flow_id&quot; and &quot;flow&quot;</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">run_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">],</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a flow. Does not return result. Implementations should cover instantiation</span>
<span class="sd">        of run_config from kwargs as well as backend-specific kwargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">                name to value</span>
<span class="sd">            run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">            **kwargs: Keyword arguments for RunConfig init and backend-specific</span>
<span class="sd">                execution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[str, None]: Return run_id in case of server backend, None in the case</span>
<span class="sd">                of local execution.</span>

<span class="sd">        Raises:</span>
<span class="sd">            pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">            ValueError: Value error on flow run</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">run_and_return</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
        <span class="n">run_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">],</span>
        <span class="n">task_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run a flow and return result. Implementations should cover instantiation of</span>
<span class="sd">        run_config from kwargs as well as backend-specific kwargs.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">                name to value</span>
<span class="sd">            run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">            task_name (Optional[str]): Name of task to return result. If no task slug</span>
<span class="sd">                is passed, will return the flow result.</span>
<span class="sd">            **kwargs: Keyword arguments for RunConfig init and backend-specific</span>
<span class="sd">                execution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Any: Result of flow run.</span>

<span class="sd">        Raises:</span>
<span class="sd">            lume_services.errors.EmptyResultError: No result is associated with the</span>
<span class="sd">                flow.</span>
<span class="sd">            pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">            ValueError: Value error on flow run</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.backend.Backend.create_project" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_project</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Create a Prefect project. Backend implementations without server connecton
should raise errors when this method is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Create a named Prefect project.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">create_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Prefect project. Backend implementations without server connecton</span>
<span class="sd">    should raise errors when this method is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name (str): Create a named Prefect project.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.backend.Backend.load_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_flow</span><span class="p">(</span><span class="n">flow_name</span><span class="p">,</span> <span class="n">project_name</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Load a Prefect flow object. Backend implementations without server connecton
should raise errors when this method is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flow_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of flow.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of project flow is registered with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with keys "flow_id" and "flow"</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">load_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flow_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Prefect flow object. Backend implementations without server connecton</span>
<span class="sd">    should raise errors when this method is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        flow_name (str): Name of flow.</span>
<span class="sd">        project_name (str): Name of project flow is registered with.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Dictionary with keys &quot;flow_id&quot; and &quot;flow&quot;</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.backend.Backend.register_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_flow</span><span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">image</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Register a flow with Prefect. Backend implementations without server connecton
should raise errors when this method is called.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flow</code>
            </td>
            <td>
                  <code>Flow</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefect flow to register.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of project to register flow to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of Docker image to run flow inside.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of registered flow.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">register_flow</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register a flow with Prefect. Backend implementations without server connecton</span>
<span class="sd">    should raise errors when this method is called.</span>

<span class="sd">    Args:</span>
<span class="sd">        flow (Flow): Prefect flow to register.</span>
<span class="sd">        project_name (str): Name of project to register flow to.</span>
<span class="sd">        image (str): Name of Docker image to run flow inside.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: ID of registered flow.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.backend.Backend.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">run_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Run a flow. Does not return result. Implementations should cover instantiation
of run_config from kwargs as well as backend-specific kwargs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code>Optional[Dict[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping flow parameter
name to value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code>Optional[RunConfig]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RunConfig object to configure flow fun.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments for RunConfig init and backend-specific
execution.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>Union[str, None]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Union[str, None]: Return run_id in case of server backend, None in the case
of local execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValidationError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error validating run configuration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value error on flow run</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">run_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a flow. Does not return result. Implementations should cover instantiation</span>
<span class="sd">    of run_config from kwargs as well as backend-specific kwargs.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">            name to value</span>
<span class="sd">        run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">        **kwargs: Keyword arguments for RunConfig init and backend-specific</span>
<span class="sd">            execution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[str, None]: Return run_id in case of server backend, None in the case</span>
<span class="sd">            of local execution.</span>

<span class="sd">    Raises:</span>
<span class="sd">        pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">        ValueError: Value error on flow run</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.backend.Backend.run_and_return" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_and_return</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">run_config</span><span class="p">,</span> <span class="n">task_name</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Run a flow and return result. Implementations should cover instantiation of
run_config from kwargs as well as backend-specific kwargs.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code>Optional[Dict[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping flow parameter
name to value</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code>Optional[RunConfig]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RunConfig object to configure flow fun.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task_name</code>
            </td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of task to return result. If no task slug
is passed, will return the flow result.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments for RunConfig init and backend-specific
execution.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Any</code></td>            <td>
                  <code>Any</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result of flow run.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>EmptyResultError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No result is associated with the
flow.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValidationError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error validating run configuration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value error on flow run</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">run_and_return</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
    <span class="n">run_config</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">RunConfig</span><span class="p">],</span>
    <span class="n">task_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a flow and return result. Implementations should cover instantiation of</span>
<span class="sd">    run_config from kwargs as well as backend-specific kwargs.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">            name to value</span>
<span class="sd">        run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">        task_name (Optional[str]): Name of task to return result. If no task slug</span>
<span class="sd">            is passed, will return the flow result.</span>
<span class="sd">        **kwargs: Keyword arguments for RunConfig init and backend-specific</span>
<span class="sd">            execution.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Any: Result of flow run.</span>

<span class="sd">    Raises:</span>
<span class="sd">        lume_services.errors.EmptyResultError: No result is associated with the</span>
<span class="sd">            flow.</span>
<span class="sd">        pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">        ValueError: Value error on flow run</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.backend.RunConfig" class="doc doc-heading">
            <code>RunConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>BaseModel</code>, <code>ABC</code></p>


        <p>Pydantic representation of Prefect UniversalRunConfig:
https://docs.prefect.io/api/latest/run_configs.html#universalrun</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.backend.RunConfig.labels">labels</span></code></td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an list of labels to apply to this run
config. Labels are string identifiers used by Prefect Agents for selecting
valid flow runs when polling for work</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.backend.RunConfig.env">env</span></code></td>
            <td>
                  <code>Optional[dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional environment variables to set on the job</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">RunConfig</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pydantic representation of Prefect UniversalRunConfig:</span>
<span class="sd">    https://docs.prefect.io/api/latest/run_configs.html#universalrun</span>


<span class="sd">    Attributes:</span>
<span class="sd">        labels (Optional[List[str]]): an list of labels to apply to this run</span>
<span class="sd">            config. Labels are string identifiers used by Prefect Agents for selecting</span>
<span class="sd">            valid flow runs when polling for work</span>
<span class="sd">        env (Optional[dict]): Additional environment variables to set on the job</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">labels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;lume-services&quot;</span><span class="p">]</span>
    <span class="n">env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefectRunConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for converting object to Prefect RunConfig type.</span>

<span class="sd">        Returns:</span>
<span class="sd">            PrefectRunConfig</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.backend.RunConfig.build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Method for converting object to Prefect RunConfig type.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>RunConfig</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PrefectRunConfig</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/backend.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefectRunConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method for converting object to Prefect RunConfig type.</span>

<span class="sd">    Returns:</span>
<span class="sd">        PrefectRunConfig</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="lume_services.services.scheduling.backends.local"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.local.LocalBackend" class="doc doc-heading">
            <code>LocalBackend</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Backend</code></p>


        <p>Backend used for local execution. This backend will raise errors on any function
calls requiring registration with the Prefect server.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.local.LocalBackend.run_config">run_config</span></code></td>
            <td>
                  <code>Optional[LocalRunConfig]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default configuration object for a given
run.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LocalBackend</span><span class="p">(</span><span class="n">Backend</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Backend used for local execution. This backend will raise errors on any function</span>
<span class="sd">    calls requiring registration with the Prefect server.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        run_config (Optional[LocalRunConfig]): Default configuration object for a given</span>
<span class="sd">            run.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">run_config</span><span class="p">:</span> <span class="n">LocalRunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run flow execution. Does not return result.</span>

<span class="sd">        Args:</span>
<span class="sd">            labels (Optional[List[str]]): an list of labels to apply to this run</span>
<span class="sd">                config. Labels are string identifiers used by Prefect Agents for</span>
<span class="sd">                selecting valid flow runs when polling for work.</span>
<span class="sd">            env (Optional[dict]): Additional environment variables to set on the job</span>
<span class="sd">            data (Optional[Dict[str, Any]]): Dictionary mapping flow parameter name to</span>
<span class="sd">                value.</span>
<span class="sd">            run_config (Optional[LocalRunConfig]): LocalRunConfig object to configure</span>
<span class="sd">                flow fun.</span>
<span class="sd">            flow (Flow): Prefect flow to execute.</span>
<span class="sd">            **kwargs: Keyword arguments to intantiate the LocalRunConfig.</span>

<span class="sd">        Raises:</span>
<span class="sd">            pydantic.ValidationError: Error validating run configuration.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Both run_config and kwargs passed to LocalBackend.run. Flow</span><span class="se">\</span>
<span class="s2">                will execute using passed run_config.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">run_config</span> <span class="o">=</span> <span class="n">LocalRunConfig</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># convert to Prefect LocalRun</span>
        <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="c1"># apply run config</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span> <span class="o">=</span> <span class="n">prefect_run_config</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">run_and_return</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">run_config</span><span class="p">:</span> <span class="n">LocalRunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Run flow execution and return result.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Optional[Dict[str, Any]]): Dictionary mapping flow parameter name to</span>
<span class="sd">                value.</span>
<span class="sd">            run_config (Optional[LocalRunConfig]): LocalRunConfig object to configure</span>
<span class="sd">                flow fun.</span>
<span class="sd">            task_name (Optional[str]): Name of task to return result. If no task slug</span>
<span class="sd">                is passed, will return the flow result.</span>
<span class="sd">            flow (Flow): Prefect flow to execute.</span>
<span class="sd">            **kwargs: Keyword arguments to intantiate the LocalRunConfig.</span>

<span class="sd">        Raises:</span>
<span class="sd">            pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">            EmptyResultError: No result is associated with the flow.</span>
<span class="sd">            TaskNotCompletedError: Result reference task was not completed.</span>
<span class="sd">            TaskNotInFlowError: Provided task slug not in flow.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Both run_config and kwargs passed to LocalBackend.run. Flow</span><span class="se">\</span>
<span class="s2">                will execute using passed run_config.&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">run_config</span> <span class="o">=</span> <span class="n">LocalRunConfig</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># convert to Prefect LocalRun</span>
        <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="c1"># apply run config</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span> <span class="o">=</span> <span class="n">prefect_run_config</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">flow_run</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">is_failed</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">flow_run</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">FlowFailedError</span><span class="p">(</span>
                    <span class="n">flow_id</span><span class="o">=</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span>
                    <span class="n">flow_run_id</span><span class="o">=</span><span class="s2">&quot;local_flow_run&quot;</span><span class="p">,</span>
                    <span class="n">exception_message</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">FlowFailedError</span><span class="p">(</span>
                <span class="n">flow_id</span><span class="o">=</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span>
                <span class="n">flow_run_id</span><span class="o">=</span><span class="s2">&quot;local_flow_run&quot;</span><span class="p">,</span>
                <span class="n">exception_message</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">result</span>

        <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">EmptyResultError</span>

        <span class="n">task_to_slug_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">task</span><span class="p">:</span> <span class="n">slug</span> <span class="k">for</span> <span class="n">task</span><span class="p">,</span> <span class="n">slug</span> <span class="ow">in</span> <span class="n">flow</span><span class="o">.</span><span class="n">slugs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="c1"># slug_to_task_map = {slug: task for task, slug in flow.slugs.items()}</span>

        <span class="c1"># account for task slug</span>
        <span class="k">if</span> <span class="n">task_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># get tasks</span>
            <span class="n">tasks</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">get_tasks</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">task_name</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">TaskNotInFlowError</span><span class="p">(</span>
                    <span class="n">flow_name</span><span class="o">=</span><span class="n">flow</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="n">task_name</span>
                <span class="p">)</span>

            <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
                <span class="n">slug</span> <span class="o">=</span> <span class="n">task_to_slug_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
                <span class="n">state</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">task</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">is_successful</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="n">TaskNotCompletedError</span><span class="p">(</span>
                        <span class="n">slug</span><span class="p">,</span> <span class="n">flow_id</span><span class="o">=</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span> <span class="n">flow_run_id</span><span class="o">=</span><span class="s2">&quot;local_flow_run&quot;</span>
                    <span class="p">)</span>

                <span class="n">res</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">result</span>
                <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyResultError</span><span class="p">(</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span> <span class="s2">&quot;local_flow_run&quot;</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span>

                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">results</span>

        <span class="c1"># else return dict of task slug to value</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">slug</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="n">task</span><span class="p">]</span><span class="o">.</span><span class="n">result</span> <span class="k">for</span> <span class="n">task</span><span class="p">,</span> <span class="n">slug</span> <span class="ow">in</span> <span class="n">task_to_slug_map</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">}</span>

    <span class="k">def</span> <span class="nf">create_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise LocalBackendError for calls to register_flow server-type method.</span>

<span class="sd">        Raises:</span>
<span class="sd">            LocalBackendError: Indicates that a server-backend operation has been</span>
<span class="sd">                executed against the LocalBackend. Server-backend operations include</span>
<span class="sd">                flow registration and remote execution.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">LocalBackendError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">register_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise LocalBackendError for calls to register_flow server-type method.</span>

<span class="sd">        Raises:</span>
<span class="sd">            LocalBackendError: Indicates that a server-backend operation has been</span>
<span class="sd">                executed against the LocalBackend. Server-backend operations include</span>
<span class="sd">                flow registration and remote execution.</span>


<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">LocalBackendError</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">load_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Raise LocalBackendError for calls to load_flow server-type method.</span>

<span class="sd">        Raises:</span>
<span class="sd">            LocalBackendError: Indicates that a server-backend operation has been</span>
<span class="sd">                executed against the LocalBackend. Server-backend operations include</span>
<span class="sd">                flow registration and remote execution.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">LocalBackendError</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.local.LocalBackend.create_project" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_project</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Raise LocalBackendError for calls to register_flow server-type method.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>LocalBackendError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates that a server-backend operation has been
executed against the LocalBackend. Server-backend operations include
flow registration and remote execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raise LocalBackendError for calls to register_flow server-type method.</span>

<span class="sd">    Raises:</span>
<span class="sd">        LocalBackendError: Indicates that a server-backend operation has been</span>
<span class="sd">            executed against the LocalBackend. Server-backend operations include</span>
<span class="sd">            flow registration and remote execution.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="n">LocalBackendError</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.local.LocalBackend.load_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_flow</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Raise LocalBackendError for calls to load_flow server-type method.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>LocalBackendError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates that a server-backend operation has been
executed against the LocalBackend. Server-backend operations include
flow registration and remote execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raise LocalBackendError for calls to load_flow server-type method.</span>

<span class="sd">    Raises:</span>
<span class="sd">        LocalBackendError: Indicates that a server-backend operation has been</span>
<span class="sd">            executed against the LocalBackend. Server-backend operations include</span>
<span class="sd">            flow registration and remote execution.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="n">LocalBackendError</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.local.LocalBackend.register_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_flow</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Raise LocalBackendError for calls to register_flow server-type method.</p>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>LocalBackendError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Indicates that a server-backend operation has been
executed against the LocalBackend. Server-backend operations include
flow registration and remote execution.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Raise LocalBackendError for calls to register_flow server-type method.</span>

<span class="sd">    Raises:</span>
<span class="sd">        LocalBackendError: Indicates that a server-backend operation has been</span>
<span class="sd">            executed against the LocalBackend. Server-backend operations include</span>
<span class="sd">            flow registration and remote execution.</span>


<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">raise</span> <span class="n">LocalBackendError</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.local.LocalBackend.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Run flow execution. Does not return result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an list of labels to apply to this run
config. Labels are string identifiers used by Prefect Agents for
selecting valid flow runs when polling for work.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>env</code>
            </td>
            <td>
                  <code>Optional[dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional environment variables to set on the job</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>Optional[Dict[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping flow parameter name to
value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code>Optional[LocalRunConfig]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LocalRunConfig object to configure
flow fun.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flow</code>
            </td>
            <td>
                  <code>Flow</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefect flow to execute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to intantiate the LocalRunConfig.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValidationError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error validating run configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">run_config</span><span class="p">:</span> <span class="n">LocalRunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run flow execution. Does not return result.</span>

<span class="sd">    Args:</span>
<span class="sd">        labels (Optional[List[str]]): an list of labels to apply to this run</span>
<span class="sd">            config. Labels are string identifiers used by Prefect Agents for</span>
<span class="sd">            selecting valid flow runs when polling for work.</span>
<span class="sd">        env (Optional[dict]): Additional environment variables to set on the job</span>
<span class="sd">        data (Optional[Dict[str, Any]]): Dictionary mapping flow parameter name to</span>
<span class="sd">            value.</span>
<span class="sd">        run_config (Optional[LocalRunConfig]): LocalRunConfig object to configure</span>
<span class="sd">            flow fun.</span>
<span class="sd">        flow (Flow): Prefect flow to execute.</span>
<span class="sd">        **kwargs: Keyword arguments to intantiate the LocalRunConfig.</span>

<span class="sd">    Raises:</span>
<span class="sd">        pydantic.ValidationError: Error validating run configuration.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Both run_config and kwargs passed to LocalBackend.run. Flow</span><span class="se">\</span>
<span class="s2">            will execute using passed run_config.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">run_config</span> <span class="o">=</span> <span class="n">LocalRunConfig</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># convert to Prefect LocalRun</span>
    <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

    <span class="c1"># apply run config</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span> <span class="o">=</span> <span class="n">prefect_run_config</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.local.LocalBackend.run_and_return" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_and_return</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">flow</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Run flow execution and return result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
                  <code>Optional[Dict[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping flow parameter name to
value.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code>Optional[LocalRunConfig]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LocalRunConfig object to configure
flow fun.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task_name</code>
            </td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of task to return result. If no task slug
is passed, will return the flow result.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flow</code>
            </td>
            <td>
                  <code>Flow</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefect flow to execute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to intantiate the LocalRunConfig.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValidationError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error validating run configuration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>EmptyResultError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No result is associated with the flow.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TaskNotCompletedError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result reference task was not completed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TaskNotInFlowError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provided task slug not in flow.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_and_return</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">run_config</span><span class="p">:</span> <span class="n">LocalRunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run flow execution and return result.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Optional[Dict[str, Any]]): Dictionary mapping flow parameter name to</span>
<span class="sd">            value.</span>
<span class="sd">        run_config (Optional[LocalRunConfig]): LocalRunConfig object to configure</span>
<span class="sd">            flow fun.</span>
<span class="sd">        task_name (Optional[str]): Name of task to return result. If no task slug</span>
<span class="sd">            is passed, will return the flow result.</span>
<span class="sd">        flow (Flow): Prefect flow to execute.</span>
<span class="sd">        **kwargs: Keyword arguments to intantiate the LocalRunConfig.</span>

<span class="sd">    Raises:</span>
<span class="sd">        pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">        EmptyResultError: No result is associated with the flow.</span>
<span class="sd">        TaskNotCompletedError: Result reference task was not completed.</span>
<span class="sd">        TaskNotInFlowError: Provided task slug not in flow.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Both run_config and kwargs passed to LocalBackend.run. Flow</span><span class="se">\</span>
<span class="s2">            will execute using passed run_config.&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">run_config</span> <span class="o">=</span> <span class="n">LocalRunConfig</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="c1"># convert to Prefect LocalRun</span>
    <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

    <span class="c1"># apply run config</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span> <span class="o">=</span> <span class="n">prefect_run_config</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">flow_run</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">is_failed</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">flow_run</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">FlowFailedError</span><span class="p">(</span>
                <span class="n">flow_id</span><span class="o">=</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span>
                <span class="n">flow_run_id</span><span class="o">=</span><span class="s2">&quot;local_flow_run&quot;</span><span class="p">,</span>
                <span class="n">exception_message</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
        <span class="k">raise</span> <span class="n">FlowFailedError</span><span class="p">(</span>
            <span class="n">flow_id</span><span class="o">=</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span>
            <span class="n">flow_run_id</span><span class="o">=</span><span class="s2">&quot;local_flow_run&quot;</span><span class="p">,</span>
            <span class="n">exception_message</span><span class="o">=</span><span class="n">e</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">result</span>

    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">EmptyResultError</span>

    <span class="n">task_to_slug_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">task</span><span class="p">:</span> <span class="n">slug</span> <span class="k">for</span> <span class="n">task</span><span class="p">,</span> <span class="n">slug</span> <span class="ow">in</span> <span class="n">flow</span><span class="o">.</span><span class="n">slugs</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="c1"># slug_to_task_map = {slug: task for task, slug in flow.slugs.items()}</span>

    <span class="c1"># account for task slug</span>
    <span class="k">if</span> <span class="n">task_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># get tasks</span>
        <span class="n">tasks</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">get_tasks</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">task_name</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">TaskNotInFlowError</span><span class="p">(</span>
                <span class="n">flow_name</span><span class="o">=</span><span class="n">flow</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="s2">&quot;local&quot;</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="n">task_name</span>
            <span class="p">)</span>

        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">task</span> <span class="ow">in</span> <span class="n">tasks</span><span class="p">:</span>
            <span class="n">slug</span> <span class="o">=</span> <span class="n">task_to_slug_map</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">task</span><span class="p">)</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">task</span><span class="p">]</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">state</span><span class="o">.</span><span class="n">is_successful</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">TaskNotCompletedError</span><span class="p">(</span>
                    <span class="n">slug</span><span class="p">,</span> <span class="n">flow_id</span><span class="o">=</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span> <span class="n">flow_run_id</span><span class="o">=</span><span class="s2">&quot;local_flow_run&quot;</span>
                <span class="p">)</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">result</span>
            <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">EmptyResultError</span><span class="p">(</span><span class="s2">&quot;local_flow&quot;</span><span class="p">,</span> <span class="s2">&quot;local_flow_run&quot;</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span>

            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tasks</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span>

    <span class="c1"># else return dict of task slug to value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">slug</span><span class="p">:</span> <span class="n">result</span><span class="p">[</span><span class="n">task</span><span class="p">]</span><span class="o">.</span><span class="n">result</span> <span class="k">for</span> <span class="n">task</span><span class="p">,</span> <span class="n">slug</span> <span class="ow">in</span> <span class="n">task_to_slug_map</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.local.LocalRunConfig" class="doc doc-heading">
            <code>LocalRunConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>RunConfig</code></p>


        <p>Local run configuration. If no directory is found at the filepath passed as
working_dir, an error will be raised.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.local.LocalRunConfig.labels">labels</span></code></td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an list of labels to apply to this run
config. Labels are string identifiers used by Prefect Agents for selecting
valid flow runs when polling for work</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.local.LocalRunConfig.env">env</span></code></td>
            <td>
                  <code>Optional[Dict[str, str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary of environment variables to use for
run</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.local.LocalRunConfig.working_dir">working_dir</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Working directory</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">LocalRunConfig</span><span class="p">(</span><span class="n">RunConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Local run configuration. If no directory is found at the filepath passed as</span>
<span class="sd">    working_dir, an error will be raised.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        labels (Optional[List[str]]): an list of labels to apply to this run</span>
<span class="sd">            config. Labels are string identifiers used by Prefect Agents for selecting</span>
<span class="sd">            valid flow runs when polling for work</span>
<span class="sd">        env (Optional[Dict[str, str]]): Dictionary of environment variables to use for</span>
<span class="sd">            run</span>
<span class="sd">        working_dir (Optional[str]): Working directory</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">env</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span>
    <span class="n">working_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;working_dir&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Pydantic validator checking working directory existence&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;No directory found at </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalRun</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for converting to Prefect RunConfig type LocalRun.</span>

<span class="sd">        Returns:</span>
<span class="sd">            LocalRun</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">LocalRun</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.local.LocalRunConfig.build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Method for converting to Prefect RunConfig type LocalRun.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>LocalRun</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>LocalRun</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">LocalRun</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method for converting to Prefect RunConfig type LocalRun.</span>

<span class="sd">    Returns:</span>
<span class="sd">        LocalRun</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">LocalRun</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.local.LocalRunConfig.validate" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Pydantic validator checking working directory existence</p>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/local.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;working_dir&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pydantic validator checking working directory existence&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="s2">&quot;No directory found at </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="lume_services.services.scheduling.backends.server"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.server.ServerBackend" class="doc doc-heading">
            <code>ServerBackend</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>Backend</code></p>


        <p>Abstract backend used for connecting to a Prefect server.</p>
<p>Prefect manages its own contexts for the purpose of registering flow objects
etc. This introduced issues with management of clients, namely that even after
setting the prefect configuration in the PrefectConfig.apply method, the
original cloud context was still being used to construct the client. For this
reason, all clients are constructed inside a context constructed from the backend
configuration.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.server.ServerBackend.config">config</span></code></td>
            <td>
                  <code>PrefectConfig</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instantiated PrefectConfig object describing connection
to Prefect server.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.server.ServerBackend.default_image">default_image</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default image used for registering flow storage.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/server.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ServerBackend</span><span class="p">(</span><span class="n">Backend</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract backend used for connecting to a Prefect server.</span>

<span class="sd">    Prefect manages its own contexts for the purpose of registering flow objects</span>
<span class="sd">    etc. This introduced issues with management of clients, namely that even after</span>
<span class="sd">    setting the prefect configuration in the PrefectConfig.apply method, the</span>
<span class="sd">    original cloud context was still being used to construct the client. For this</span>
<span class="sd">    reason, all clients are constructed inside a context constructed from the backend</span>
<span class="sd">    configuration.</span>


<span class="sd">    Attributes:</span>
<span class="sd">        config (PrefectConfig): Instantiated PrefectConfig object describing connection</span>
<span class="sd">            to Prefect server.</span>
<span class="sd">        default_image (str): Default image used for registering flow storage.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">config</span><span class="p">:</span> <span class="n">PrefectConfig</span>

    <span class="k">class</span> <span class="nc">Config</span><span class="p">:</span>
        <span class="n">underscore_attrs_are_private</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="nd">@abstractproperty</span>
    <span class="k">def</span> <span class="nf">run_config_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefectRunConfig</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Abstract property that must return the Prefect RunConfig type pertinent to</span>
<span class="sd">        the Backend implementation.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">create_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a Prefect project.</span>

<span class="sd">        Args:</span>
<span class="sd">            project_name (str): Create a named Prefect project.</span>

<span class="sd">        Raises:</span>
<span class="sd">            prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
            <span class="n">client</span><span class="o">.</span><span class="n">create_project</span><span class="p">(</span><span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">register_flow</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
        <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">idempotency_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">version_group_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">build</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">no_url</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">set_schedule_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Register a flow with Prefect.</span>

<span class="sd">        Args:</span>
<span class="sd">            flow (Flow): Prefect flow to register</span>
<span class="sd">            project_name (str): Name of project to register flow to</span>
<span class="sd">            image (str): Name of Docker image to run flow inside. If not specified,</span>
<span class="sd">                this will use the default image packaged with this repository.</span>
<span class="sd">            build (bool): Whether the flows storage should be built prior to</span>
<span class="sd">                serialization. By default lume-services flows use the same</span>
<span class="sd">                image for execution with additional packages passed for installation</span>
<span class="sd">                configured at runtime.</span>
<span class="sd">            labels (Optional[List[str]]): A list of labels to add to this Flow.</span>
<span class="sd">            idempotency_key (Optional[str]): a key that, if matching the most recent</span>
<span class="sd">                registration call for this flow group, will prevent the creation of</span>
<span class="sd">                another flow version and return the existing flow id instead.</span>
<span class="sd">            version_group_id (Optional[str]): The UUID version group ID to use for</span>
<span class="sd">                versioning this Flow in Cloud. If not provided, the version group ID</span>
<span class="sd">                associated with this Flow&#39;s project and name will be used.</span>
<span class="sd">            no_url (Optional[bool]): If True, the stdout from this function will not</span>
<span class="sd">                contain the URL link to the newly-registered flow in the UI</span>
<span class="sd">            set_schedule_active (Optional[bool]): If False, will set the schedule to</span>
<span class="sd">                inactive in the database to prevent auto-scheduling runs (if the Flow</span>
<span class="sd">                has a schedule)</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: ID of registered flow</span>

<span class="sd">        Notes:</span>
<span class="sd">            prefect registration idempotency key omitted and version group...</span>

<span class="sd">        Raises:</span>
<span class="sd">            prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">image</span><span class="p">:</span>
            <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_image</span>

        <span class="c1"># configure run config for backend</span>
        <span class="n">run_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_config_type</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">)</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Flow run config is not empty. Clearing existing labels and assigning </span><span class="se">\</span>
<span class="s2">                    new.&quot;</span>
            <span class="p">)</span>
            <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

        <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span><span class="o">.</span><span class="n">image_tag</span> <span class="o">=</span> <span class="n">image</span>

        <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
            <span class="n">flow_id</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
                <span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span>
                <span class="n">build</span><span class="o">=</span><span class="n">build</span><span class="p">,</span>
                <span class="n">set_schedule_active</span><span class="o">=</span><span class="n">set_schedule_active</span><span class="p">,</span>
                <span class="n">version_group_id</span><span class="o">=</span><span class="n">version_group_id</span><span class="p">,</span>
                <span class="n">no_url</span><span class="o">=</span><span class="n">no_url</span><span class="p">,</span>
                <span class="n">idempotency_key</span><span class="o">=</span><span class="n">idempotency_key</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">flow_id</span>

    <span class="k">def</span> <span class="nf">load_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flow_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load a Prefect flow object.</span>

<span class="sd">        Args:</span>
<span class="sd">            flow_name (str): Name of flow.</span>
<span class="sd">            project_name (str): Name of project flow is registered with.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: Dictionary with keys &quot;flow_id&quot; and &quot;flow&quot;</span>

<span class="sd">        Raises:</span>
<span class="sd">            prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_name</span><span class="p">(</span>
            <span class="n">flow_name</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span> <span class="n">last_updated</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
            <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_name</span><span class="p">(</span>
                <span class="n">flow_name</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span> <span class="n">last_updated</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">flow_id</span><span class="p">,</span> <span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">flow</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">run_config</span><span class="p">:</span> <span class="n">RunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">flow_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a flow run for a flow.</span>

<span class="sd">        Args:</span>
<span class="sd">            flow_id (str): Flow identifier</span>
<span class="sd">            parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">                name to value</span>
<span class="sd">            run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">            **kwargs: Keyword arguments to intantiate the RunConfig.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: ID of flow run</span>

<span class="sd">        Raises:</span>
<span class="sd">            prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>
<span class="sd">            docker.errors.DockerException: Run configuration error for docker api.</span>
<span class="sd">            pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">            ValueError: Value error on flow run</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Both run_config and kwargs passed to Backend.run. Flow</span><span class="se">\</span>
<span class="s2">                will execute using passed run_config.&quot;</span>
            <span class="p">)</span>

        <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>

            <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_id</span><span class="p">(</span><span class="n">flow_id</span><span class="p">)</span>

            <span class="c1"># convert LUME-services run config to appropriate Prefect RunConfig object</span>
            <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">run_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_config_type</span><span class="p">(</span>
                    <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PREFECT__CONTEXT__PROJECT_NAME&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">project_name</span><span class="p">},</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

            <span class="n">flow_run_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_flow_run</span><span class="p">(</span>
                <span class="n">flow_id</span><span class="o">=</span><span class="n">flow_id</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="n">prefect_run_config</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">flow_run_id</span>

    <span class="k">def</span> <span class="nf">run_and_return</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">run_config</span><span class="p">:</span> <span class="n">RunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">flow_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
        <span class="n">cancel_on_timeout</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a flow run for a flow and return the result.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">                name to value</span>
<span class="sd">            run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">            task_name (Optional[str]): Name of task to return result. If no task slug</span>
<span class="sd">                is passed, will return the flow result.</span>
<span class="sd">            flow_id (str): ID of flow to run.</span>
<span class="sd">            timeout (timedelta): Time before stopping flow execution.</span>
<span class="sd">            cancel_on_timeout (bool): Whether to cancel execution on timeout</span>
<span class="sd">                error.</span>
<span class="sd">            **kwargs: Keyword arguments to intantiate the RunConfig.</span>

<span class="sd">        Raises:</span>
<span class="sd">            EmptyResultError: No result is associated with the flow.</span>
<span class="sd">            TaskNotCompletedError: Result reference task was not completed.</span>
<span class="sd">            RuntimeError: Flow did not complete within given timeout.</span>
<span class="sd">            prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>
<span class="sd">            docker.errors.DockerException: Run configuration error for docker api.</span>
<span class="sd">            pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">            TaskNotInFlowError: Provided task slug not in flow.</span>
<span class="sd">            ValueError: Value error on flow run</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;Both run_config and kwargs passed to Backend.run. Flow</span><span class="se">\</span>
<span class="s2">                will execute using passed run_config.&quot;</span>
            <span class="p">)</span>

        <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
            <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>

            <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_id</span><span class="p">(</span><span class="n">flow_id</span><span class="p">)</span>

            <span class="c1"># convert LUME-services run config to appropriate Prefect RunConfig object</span>
            <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">run_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_config_type</span><span class="p">(</span>
                    <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PREFECT__CONTEXT__PROJECT_NAME&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">project_name</span><span class="p">},</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;Creating Prefect flow run for </span><span class="si">%s</span><span class="s2"> with parameters </span><span class="si">%s</span><span class="s2"> and run_config </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">flow_id</span><span class="p">,</span>
                <span class="n">parameters</span><span class="p">,</span>
                <span class="n">run_config</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span>
            <span class="p">)</span>

            <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

            <span class="n">flow_run_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_flow_run</span><span class="p">(</span>
                <span class="n">flow_id</span><span class="o">=</span><span class="n">flow_id</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="n">prefect_run_config</span>
            <span class="p">)</span>

            <span class="c1"># watch flow run and stream logs until timeout</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">watch_flow_run</span><span class="p">(</span>
                    <span class="n">flow_run_id</span><span class="p">,</span>
                    <span class="n">stream_states</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">stream_logs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                    <span class="n">max_duration</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
                <span class="p">):</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">cancel_on_timeout</span><span class="p">:</span>
                    <span class="n">client</span><span class="o">.</span><span class="n">cancel_flow_run</span><span class="p">(</span><span class="n">flow_run_id</span><span class="o">=</span><span class="n">flow_run_id</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">err</span>

            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Watched flow completed.&quot;</span><span class="p">)</span>
            <span class="n">flow_run</span> <span class="o">=</span> <span class="n">FlowRunView</span><span class="o">.</span><span class="n">from_flow_run_id</span><span class="p">(</span><span class="n">flow_run_id</span><span class="p">)</span>

            <span class="c1"># check state</span>
            <span class="k">if</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">is_failed</span><span class="p">():</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">FlowFailedError</span><span class="p">(</span>
                    <span class="n">flow_id</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">flow_id</span><span class="p">,</span>
                    <span class="n">flow_run_id</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">flow_run_id</span><span class="p">,</span>
                    <span class="n">exception_message</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">task_runs</span> <span class="o">=</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">get_all_task_runs</span><span class="p">()</span>

            <span class="c1"># populate tasks</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">task_run</span> <span class="ow">in</span> <span class="n">task_runs</span><span class="p">:</span>
                <span class="n">slug</span> <span class="o">=</span> <span class="n">task_run</span><span class="o">.</span><span class="n">task_slug</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">task_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">is_successful</span><span class="p">():</span>
                    <span class="k">raise</span> <span class="n">TaskNotCompletedError</span><span class="p">(</span><span class="n">slug</span><span class="p">,</span> <span class="n">flow_id</span><span class="p">,</span> <span class="n">flow_run_id</span><span class="p">)</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="n">task_run</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
                <span class="c1"># location is not set, no result</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>

                <span class="n">results</span><span class="p">[</span><span class="n">slug</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

        <span class="c1"># get task run</span>
        <span class="k">if</span> <span class="n">task_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># filter tasks based on name</span>
            <span class="n">task_runs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="n">slug</span><span class="p">:</span> <span class="n">res</span> <span class="k">for</span> <span class="n">slug</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">task_name</span> <span class="ow">in</span> <span class="n">slug</span>
            <span class="p">}</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">task_runs</span><span class="p">)</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">task_runs</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">TaskNotInFlowError</span><span class="p">(</span>
                    <span class="n">flow_name</span><span class="o">=</span><span class="n">flow_view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                    <span class="n">project_name</span><span class="o">=</span><span class="n">flow_view</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span>
                    <span class="n">task_name</span><span class="o">=</span><span class="n">task_name</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">task_runs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">task_runs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">EmptyResultError</span><span class="p">(</span><span class="n">flow_id</span><span class="p">,</span> <span class="n">flow_run_id</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span>

                <span class="k">return</span> <span class="n">res</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">task_runs</span>

        <span class="c1"># assume flow result, return all results</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.server.ServerBackend.create_project" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_project</span><span class="p">(</span><span class="n">project_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a Prefect project.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Create a named Prefect project.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ClientError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the GraphQL query is bad for any reason</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">create_project</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a Prefect project.</span>

<span class="sd">    Args:</span>
<span class="sd">        project_name (str): Create a named Prefect project.</span>

<span class="sd">    Raises:</span>
<span class="sd">        prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>
        <span class="n">client</span><span class="o">.</span><span class="n">create_project</span><span class="p">(</span><span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.server.ServerBackend.load_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load_flow</span><span class="p">(</span><span class="n">flow_name</span><span class="p">,</span> <span class="n">project_name</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Load a Prefect flow object.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flow_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of flow.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of project flow is registered with.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>dict</code></td>            <td>
                  <code>dict</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary with keys "flow_id" and "flow"</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ClientError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the GraphQL query is bad for any reason</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">load_flow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flow_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Load a Prefect flow object.</span>

<span class="sd">    Args:</span>
<span class="sd">        flow_name (str): Name of flow.</span>
<span class="sd">        project_name (str): Name of project flow is registered with.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: Dictionary with keys &quot;flow_id&quot; and &quot;flow&quot;</span>

<span class="sd">    Raises:</span>
<span class="sd">        prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_name</span><span class="p">(</span>
        <span class="n">flow_name</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span> <span class="n">last_updated</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
    <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
        <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_name</span><span class="p">(</span>
            <span class="n">flow_name</span><span class="p">,</span> <span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span> <span class="n">last_updated</span><span class="o">=</span><span class="kc">True</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;flow_id&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">flow_id</span><span class="p">,</span> <span class="s2">&quot;flow&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">flow</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.server.ServerBackend.register_flow" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">register_flow</span><span class="p">(</span><span class="n">flow</span><span class="p">,</span> <span class="n">project_name</span><span class="p">,</span> <span class="n">image</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">idempotency_key</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">version_group_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">build</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">no_url</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">set_schedule_active</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Register a flow with Prefect.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flow</code>
            </td>
            <td>
                  <code>Flow</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefect flow to register</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>project_name</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of project to register flow to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of Docker image to run flow inside. If not specified,
this will use the default image packaged with this repository.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>build</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether the flows storage should be built prior to
serialization. By default lume-services flows use the same
image for execution with additional packages passed for installation
configured at runtime.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>labels</code>
            </td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of labels to add to this Flow.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>idempotency_key</code>
            </td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>a key that, if matching the most recent
registration call for this flow group, will prevent the creation of
another flow version and return the existing flow id instead.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>version_group_id</code>
            </td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The UUID version group ID to use for
versioning this Flow in Cloud. If not provided, the version group ID
associated with this Flow's project and name will be used.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>no_url</code>
            </td>
            <td>
                  <code>Optional[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, the stdout from this function will not
contain the URL link to the newly-registered flow in the UI</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>set_schedule_active</code>
            </td>
            <td>
                  <code>Optional[bool]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If False, will set the schedule to
inactive in the database to prevent auto-scheduling runs (if the Flow
has a schedule)</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of registered flow</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="notes" open>
  <summary>Notes</summary>
  <p>prefect registration idempotency key omitted and version group...</p>
</details>

<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ClientError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the GraphQL query is bad for any reason</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">register_flow</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">flow</span><span class="p">:</span> <span class="n">Flow</span><span class="p">,</span>
    <span class="n">project_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">idempotency_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">version_group_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">build</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">no_url</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">set_schedule_active</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Register a flow with Prefect.</span>

<span class="sd">    Args:</span>
<span class="sd">        flow (Flow): Prefect flow to register</span>
<span class="sd">        project_name (str): Name of project to register flow to</span>
<span class="sd">        image (str): Name of Docker image to run flow inside. If not specified,</span>
<span class="sd">            this will use the default image packaged with this repository.</span>
<span class="sd">        build (bool): Whether the flows storage should be built prior to</span>
<span class="sd">            serialization. By default lume-services flows use the same</span>
<span class="sd">            image for execution with additional packages passed for installation</span>
<span class="sd">            configured at runtime.</span>
<span class="sd">        labels (Optional[List[str]]): A list of labels to add to this Flow.</span>
<span class="sd">        idempotency_key (Optional[str]): a key that, if matching the most recent</span>
<span class="sd">            registration call for this flow group, will prevent the creation of</span>
<span class="sd">            another flow version and return the existing flow id instead.</span>
<span class="sd">        version_group_id (Optional[str]): The UUID version group ID to use for</span>
<span class="sd">            versioning this Flow in Cloud. If not provided, the version group ID</span>
<span class="sd">            associated with this Flow&#39;s project and name will be used.</span>
<span class="sd">        no_url (Optional[bool]): If True, the stdout from this function will not</span>
<span class="sd">            contain the URL link to the newly-registered flow in the UI</span>
<span class="sd">        set_schedule_active (Optional[bool]): If False, will set the schedule to</span>
<span class="sd">            inactive in the database to prevent auto-scheduling runs (if the Flow</span>
<span class="sd">            has a schedule)</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: ID of registered flow</span>

<span class="sd">    Notes:</span>
<span class="sd">        prefect registration idempotency key omitted and version group...</span>

<span class="sd">    Raises:</span>
<span class="sd">        prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">image</span><span class="p">:</span>
        <span class="n">image</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_image</span>

    <span class="c1"># configure run config for backend</span>
    <span class="n">run_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_config_type</span><span class="p">(</span><span class="n">image</span><span class="o">=</span><span class="n">image</span><span class="p">)</span>
    <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Flow run config is not empty. Clearing existing labels and assigning </span><span class="se">\</span>
<span class="s2">                new.&quot;</span>
        <span class="p">)</span>
        <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span><span class="o">.</span><span class="n">labels</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

    <span class="n">flow</span><span class="o">.</span><span class="n">run_config</span><span class="o">.</span><span class="n">image_tag</span> <span class="o">=</span> <span class="n">image</span>

    <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
        <span class="n">flow_id</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">register</span><span class="p">(</span>
            <span class="n">project_name</span><span class="o">=</span><span class="n">project_name</span><span class="p">,</span>
            <span class="n">build</span><span class="o">=</span><span class="n">build</span><span class="p">,</span>
            <span class="n">set_schedule_active</span><span class="o">=</span><span class="n">set_schedule_active</span><span class="p">,</span>
            <span class="n">version_group_id</span><span class="o">=</span><span class="n">version_group_id</span><span class="p">,</span>
            <span class="n">no_url</span><span class="o">=</span><span class="n">no_url</span><span class="p">,</span>
            <span class="n">idempotency_key</span><span class="o">=</span><span class="n">idempotency_key</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">flow_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.server.ServerBackend.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">flow_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a flow run for a flow.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>flow_id</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flow identifier</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code>Optional[Dict[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping flow parameter
name to value</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code>Optional[RunConfig]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RunConfig object to configure flow fun.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to intantiate the RunConfig.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of flow run</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ClientError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the GraphQL query is bad for any reason</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>DockerException</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run configuration error for docker api.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValidationError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error validating run configuration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value error on flow run</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">run_config</span><span class="p">:</span> <span class="n">RunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">flow_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a flow run for a flow.</span>

<span class="sd">    Args:</span>
<span class="sd">        flow_id (str): Flow identifier</span>
<span class="sd">        parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">            name to value</span>
<span class="sd">        run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">        **kwargs: Keyword arguments to intantiate the RunConfig.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: ID of flow run</span>

<span class="sd">    Raises:</span>
<span class="sd">        prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>
<span class="sd">        docker.errors.DockerException: Run configuration error for docker api.</span>
<span class="sd">        pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">        ValueError: Value error on flow run</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Both run_config and kwargs passed to Backend.run. Flow</span><span class="se">\</span>
<span class="s2">            will execute using passed run_config.&quot;</span>
        <span class="p">)</span>

    <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>

        <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_id</span><span class="p">(</span><span class="n">flow_id</span><span class="p">)</span>

        <span class="c1"># convert LUME-services run config to appropriate Prefect RunConfig object</span>
        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">run_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_config_type</span><span class="p">(</span>
                <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PREFECT__CONTEXT__PROJECT_NAME&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">project_name</span><span class="p">},</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="n">flow_run_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_flow_run</span><span class="p">(</span>
            <span class="n">flow_id</span><span class="o">=</span><span class="n">flow_id</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="n">prefect_run_config</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">flow_run_id</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.server.ServerBackend.run_and_return" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_and_return</span><span class="p">(</span><span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">task_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">flow_id</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">cancel_on_timeout</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Create a flow run for a flow and return the result.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code>Optional[Dict[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary mapping flow parameter
name to value</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>run_config</code>
            </td>
            <td>
                  <code>Optional[RunConfig]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>RunConfig object to configure flow fun.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>task_name</code>
            </td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of task to return result. If no task slug
is passed, will return the flow result.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>flow_id</code>
            </td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>ID of flow to run.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>timeout</code>
            </td>
            <td>
                  <code>timedelta</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Time before stopping flow execution.</p>
              </div>
            </td>
            <td>
                  <code>timedelta(minutes=1)</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>cancel_on_timeout</code>
            </td>
            <td>
                  <code>bool</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Whether to cancel execution on timeout
error.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to intantiate the RunConfig.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>EmptyResultError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>No result is associated with the flow.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TaskNotCompletedError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Result reference task was not completed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>RuntimeError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flow did not complete within given timeout.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ClientError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>if the GraphQL query is bad for any reason</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>DockerException</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Run configuration error for docker api.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValidationError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Error validating run configuration.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>TaskNotInFlowError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Provided task slug not in flow.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value error on flow run</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">run_and_return</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">run_config</span><span class="p">:</span> <span class="n">RunConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">task_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">flow_id</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="n">timedelta</span> <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
    <span class="n">cancel_on_timeout</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a flow run for a flow and return the result.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameters (Optional[Dict[str, Any]]): Dictionary mapping flow parameter</span>
<span class="sd">            name to value</span>
<span class="sd">        run_config (Optional[RunConfig]): RunConfig object to configure flow fun.</span>
<span class="sd">        task_name (Optional[str]): Name of task to return result. If no task slug</span>
<span class="sd">            is passed, will return the flow result.</span>
<span class="sd">        flow_id (str): ID of flow to run.</span>
<span class="sd">        timeout (timedelta): Time before stopping flow execution.</span>
<span class="sd">        cancel_on_timeout (bool): Whether to cancel execution on timeout</span>
<span class="sd">            error.</span>
<span class="sd">        **kwargs: Keyword arguments to intantiate the RunConfig.</span>

<span class="sd">    Raises:</span>
<span class="sd">        EmptyResultError: No result is associated with the flow.</span>
<span class="sd">        TaskNotCompletedError: Result reference task was not completed.</span>
<span class="sd">        RuntimeError: Flow did not complete within given timeout.</span>
<span class="sd">        prefect.errors.ClientError: if the GraphQL query is bad for any reason</span>
<span class="sd">        docker.errors.DockerException: Run configuration error for docker api.</span>
<span class="sd">        pydantic.ValidationError: Error validating run configuration.</span>
<span class="sd">        TaskNotInFlowError: Provided task slug not in flow.</span>
<span class="sd">        ValueError: Value error on flow run</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;Both run_config and kwargs passed to Backend.run. Flow</span><span class="se">\</span>
<span class="s2">            will execute using passed run_config.&quot;</span>
        <span class="p">)</span>

    <span class="k">with</span> <span class="n">prefect</span><span class="o">.</span><span class="n">context</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">apply</span><span class="p">()):</span>
        <span class="n">client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">()</span>

        <span class="n">flow_view</span> <span class="o">=</span> <span class="n">FlowView</span><span class="o">.</span><span class="n">from_flow_id</span><span class="p">(</span><span class="n">flow_id</span><span class="p">)</span>

        <span class="c1"># convert LUME-services run config to appropriate Prefect RunConfig object</span>
        <span class="k">if</span> <span class="n">run_config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">run_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_config_type</span><span class="p">(</span>
                <span class="n">env</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;PREFECT__CONTEXT__PROJECT_NAME&quot;</span><span class="p">:</span> <span class="n">flow_view</span><span class="o">.</span><span class="n">project_name</span><span class="p">},</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;Creating Prefect flow run for </span><span class="si">%s</span><span class="s2"> with parameters </span><span class="si">%s</span><span class="s2"> and run_config </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">flow_id</span><span class="p">,</span>
            <span class="n">parameters</span><span class="p">,</span>
            <span class="n">run_config</span><span class="o">.</span><span class="n">json</span><span class="p">(),</span>
        <span class="p">)</span>

        <span class="n">prefect_run_config</span> <span class="o">=</span> <span class="n">run_config</span><span class="o">.</span><span class="n">build</span><span class="p">()</span>

        <span class="n">flow_run_id</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">create_flow_run</span><span class="p">(</span>
            <span class="n">flow_id</span><span class="o">=</span><span class="n">flow_id</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">parameters</span><span class="p">,</span> <span class="n">run_config</span><span class="o">=</span><span class="n">prefect_run_config</span>
        <span class="p">)</span>

        <span class="c1"># watch flow run and stream logs until timeout</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">watch_flow_run</span><span class="p">(</span>
                <span class="n">flow_run_id</span><span class="p">,</span>
                <span class="n">stream_states</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">stream_logs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">max_duration</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">cancel_on_timeout</span><span class="p">:</span>
                <span class="n">client</span><span class="o">.</span><span class="n">cancel_flow_run</span><span class="p">(</span><span class="n">flow_run_id</span><span class="o">=</span><span class="n">flow_run_id</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">err</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Watched flow completed.&quot;</span><span class="p">)</span>
        <span class="n">flow_run</span> <span class="o">=</span> <span class="n">FlowRunView</span><span class="o">.</span><span class="n">from_flow_run_id</span><span class="p">(</span><span class="n">flow_run_id</span><span class="p">)</span>

        <span class="c1"># check state</span>
        <span class="k">if</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">is_failed</span><span class="p">():</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">FlowFailedError</span><span class="p">(</span>
                <span class="n">flow_id</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">flow_id</span><span class="p">,</span>
                <span class="n">flow_run_id</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">flow_run_id</span><span class="p">,</span>
                <span class="n">exception_message</span><span class="o">=</span><span class="n">flow_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">message</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">task_runs</span> <span class="o">=</span> <span class="n">flow_run</span><span class="o">.</span><span class="n">get_all_task_runs</span><span class="p">()</span>

        <span class="c1"># populate tasks</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">task_run</span> <span class="ow">in</span> <span class="n">task_runs</span><span class="p">:</span>
            <span class="n">slug</span> <span class="o">=</span> <span class="n">task_run</span><span class="o">.</span><span class="n">task_slug</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">task_run</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">is_successful</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">TaskNotCompletedError</span><span class="p">(</span><span class="n">slug</span><span class="p">,</span> <span class="n">flow_id</span><span class="p">,</span> <span class="n">flow_run_id</span><span class="p">)</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="n">task_run</span><span class="o">.</span><span class="n">get_result</span><span class="p">()</span>
            <span class="c1"># location is not set, no result</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">res</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="n">results</span><span class="p">[</span><span class="n">slug</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span>

    <span class="c1"># get task run</span>
    <span class="k">if</span> <span class="n">task_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># filter tasks based on name</span>
        <span class="n">task_runs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">slug</span><span class="p">:</span> <span class="n">res</span> <span class="k">for</span> <span class="n">slug</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">task_name</span> <span class="ow">in</span> <span class="n">slug</span>
        <span class="p">}</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">task_runs</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">task_runs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">TaskNotInFlowError</span><span class="p">(</span>
                <span class="n">flow_name</span><span class="o">=</span><span class="n">flow_view</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">project_name</span><span class="o">=</span><span class="n">flow_view</span><span class="o">.</span><span class="n">project_name</span><span class="p">,</span>
                <span class="n">task_name</span><span class="o">=</span><span class="n">task_name</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">task_runs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">task_runs</span><span class="o">.</span><span class="n">values</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">EmptyResultError</span><span class="p">(</span><span class="n">flow_id</span><span class="p">,</span> <span class="n">flow_run_id</span><span class="p">,</span> <span class="n">slug</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">res</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">task_runs</span>

    <span class="c1"># assume flow result, return all results</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">results</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.server.ServerBackend.run_config_type" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_config_type</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Abstract property that must return the Prefect RunConfig type pertinent to
the Backend implementation.</p>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/server.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractproperty</span>
<span class="k">def</span> <span class="nf">run_config_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">PrefectRunConfig</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Abstract property that must return the Prefect RunConfig type pertinent to</span>
<span class="sd">    the Backend implementation.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="o">...</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="lume_services.services.scheduling.backends.docker"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.docker.DockerBackend" class="doc doc-heading">
            <code>DockerBackend</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>ServerBackend</code></p>


        <p>Implementation of Backend used for interacting with prefect deployed in
cluster of Docker containers, as with docker-compose.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerBackend.config">config</span></code></td>
            <td>
                  <code>PrefectConfig</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instantiated PrefectConfig object describing connection
to Prefect server.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerBackend._client">_client</span></code></td>
            <td>
                  <code>Client</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefect client connection created on instantiation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerBackend._run_config_type">_run_config_type</span></code></td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type used to compose Prefect run configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/docker.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DockerBackend</span><span class="p">(</span><span class="n">ServerBackend</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of Backend used for interacting with prefect deployed in</span>
<span class="sd">    cluster of Docker containers, as with docker-compose.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        config (PrefectConfig): Instantiated PrefectConfig object describing connection</span>
<span class="sd">            to Prefect server.</span>
<span class="sd">        _client (Client): Prefect client connection created on instantiation.</span>
<span class="sd">        _run_config_type (type): Type used to compose Prefect run configuration.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_run_config_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">DockerRunConfig</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">run_config_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_config_type</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.docker.DockerRunConfig" class="doc doc-heading">
            <code>DockerRunConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>RunConfig</code></p>


        <p>Pydantic representation of a Docker Prefect run configuration:
https://docs.prefect.io/api/latest/run_configs.html#dockerrun</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerRunConfig.labels">labels</span></code></td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an list of labels to apply to this run
config. Labels are string identifiers used by Prefect Agents for selecting
valid flow runs when polling for work</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerRunConfig.env">env</span></code></td>
            <td>
                  <code>Optional[dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional environment variables to set on the job</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerRunConfig.image">image</span></code></td>
            <td>
                  <code>str</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tag of image in which flow should run.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerRunConfig.host_config">host_config</span></code></td>
            <td>
                  <code>Optional[Dict[str, Any]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Dictionary representing runtime args
to be passed to Docker agent. Full documentation of args can be found here:
https://docker-py.readthedocs.io/en/stable/api.html#docker.api.container.ContainerApiMixin.create_host_config</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.docker.DockerRunConfig.ports">ports</span></code></td>
            <td>
                  <code>Optional[List[int]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An list of ports numbers to expose on
container.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/docker.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">DockerRunConfig</span><span class="p">(</span><span class="n">RunConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pydantic representation of a Docker Prefect run configuration:</span>
<span class="sd">    https://docs.prefect.io/api/latest/run_configs.html#dockerrun</span>

<span class="sd">    Attributes:</span>
<span class="sd">        labels (Optional[List[str]]): an list of labels to apply to this run</span>
<span class="sd">            config. Labels are string identifiers used by Prefect Agents for selecting</span>
<span class="sd">            valid flow runs when polling for work</span>
<span class="sd">        env (Optional[dict]): Additional environment variables to set on the job</span>
<span class="sd">        image (str): Tag of image in which flow should run.</span>
<span class="sd">        host_config (Optional[Dict[str, Any]]): Dictionary representing runtime args</span>
<span class="sd">            to be passed to Docker agent. Full documentation of args can be found here:</span>
<span class="sd">            https://docker-py.readthedocs.io/en/stable/api.html#docker.api.container.ContainerApiMixin.create_host_config</span>
<span class="sd">        ports (Optional[List[int]]): An list of ports numbers to expose on</span>
<span class="sd">            container.</span>

<span class="sd">    &quot;&quot;&quot;</span>  <span class="c1"># noqa</span>

    <span class="n">image</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">host_config</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">ports</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;host_config&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_host_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Composes a model for the Docker host configuration and applies any passed</span>
<span class="sd">        values.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,)):</span>
            <span class="c1"># test host config composition using api version</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">HostConfig</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">docker_api_version</span><span class="p">(),</span> <span class="o">**</span><span class="n">v</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">e</span>

        <span class="k">return</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DockerRun</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for converting to Prefect RunConfig type DockerRun.</span>

<span class="sd">        Returns:</span>
<span class="sd">            DockerRun</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">DockerRun</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.docker.DockerRunConfig.build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Method for converting to Prefect RunConfig type DockerRun.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>DockerRun</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>DockerRun</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/docker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DockerRun</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method for converting to Prefect RunConfig type DockerRun.</span>

<span class="sd">    Returns:</span>
<span class="sd">        DockerRun</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">DockerRun</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.docker.DockerRunConfig.validate_host_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_host_config</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Composes a model for the Docker host configuration and applies any passed
values.</p>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/docker.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;host_config&quot;</span><span class="p">,</span> <span class="n">pre</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_host_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Composes a model for the Docker host configuration and applies any passed</span>
<span class="sd">    values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,)):</span>
        <span class="c1"># test host config composition using api version</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">HostConfig</span><span class="p">(</span><span class="n">version</span><span class="o">=</span><span class="n">docker_api_version</span><span class="p">(),</span> <span class="o">**</span><span class="n">v</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">exception</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">e</span>

    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<a id="lume_services.services.scheduling.backends.kubernetes"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.kubernetes.KubernetesBackend" class="doc doc-heading">
            <code>KubernetesBackend</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>ServerBackend</code></p>


        <p>Implementation of Backend used for interacting with Prefect deployed in
K8 cluster.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesBackend.config">config</span></code></td>
            <td>
                  <code>PrefectConfig</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Instantiated PrefectConfig object describing connection
to Prefect server.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesBackend._client">_client</span></code></td>
            <td>
                  <code>Client</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Prefect client connection created on instantiation.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesBackend._run_config_type">_run_config_type</span></code></td>
            <td>
                  <code>type</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Type used to compose run configuration.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/kubernetes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">KubernetesBackend</span><span class="p">(</span><span class="n">ServerBackend</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Implementation of Backend used for interacting with Prefect deployed in</span>
<span class="sd">    K8 cluster.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        config (PrefectConfig): Instantiated PrefectConfig object describing connection</span>
<span class="sd">            to Prefect server.</span>
<span class="sd">        _client (Client): Prefect client connection created on instantiation.</span>
<span class="sd">        _run_config_type (type): Type used to compose run configuration.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">_run_config_type</span><span class="p">:</span> <span class="nb">type</span> <span class="o">=</span> <span class="n">KubernetesRunConfig</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">run_config_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_run_config_type</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig" class="doc doc-heading">
            <code>KubernetesRunConfig</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code>RunConfig</code></p>


        <p>Pydantic representation of args to:
https://docs.prefect.io/api/latest/run_configs.html#kubernetesrun
https://kubernetes.io/docs/concepts/configuration/overview/#container-images</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.labels">labels</span></code></td>
            <td>
                  <code>Optional[List[str]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>an list of labels to apply to this run
config. Labels are string identifiers used by Prefect Agents for selecting
valid flow runs when polling for work</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.env">env</span></code></td>
            <td>
                  <code>Optional[dict]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional environment variables to set on the job</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.image">image</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The image to use. Can also be specified via job
template.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.job_template_path">job_template_path</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to a job template to use. If a local
path (no file scheme, or a file/local scheme), the job template will be
loaded on initialization and stored on the KubernetesRun object as the
job_template field. Otherwise the job template will be loaded at runtime
on the agent. Supported runtime file schemes include (s3, gcs, and agent
(for paths local to the runtime agent)).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.job_template">job_template</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>An in-memory job template to use.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.cpu_limit">cpu_limit</span></code></td>
            <td>
                  <code>Union[float, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The CPU limit to use for the job</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.cpu_request">cpu_request</span></code></td>
            <td>
                  <code>Union[float, str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The CPU request to use for the job</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.memory_limit">memory_limit</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The memory limit to use for the job</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.memory_request">memory_request</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The memory request to use for the job</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.service_account_name">service_account_name</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A service account name to use for this
job. If present, overrides any service account configured on the agent or
in the job template.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.image_pull_secrets">image_pull_secrets</span></code></td>
            <td>
                  <code>Optional[list]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of image pull secrets to use for
this job. If present, overrides any image pull secrets configured on the
agent or in the job template.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.image_pull_policy">image_pull_policy</span></code></td>
            <td>
                  <code>Optional[str]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The imagePullPolicy to use for the job.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>lume_services/services/scheduling/backends/kubernetes.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">KubernetesRunConfig</span><span class="p">(</span><span class="n">RunConfig</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pydantic representation of args to:</span>
<span class="sd">    https://docs.prefect.io/api/latest/run_configs.html#kubernetesrun</span>
<span class="sd">    https://kubernetes.io/docs/concepts/configuration/overview/#container-images</span>

<span class="sd">    Attributes:</span>
<span class="sd">        labels (Optional[List[str]]): an list of labels to apply to this run</span>
<span class="sd">            config. Labels are string identifiers used by Prefect Agents for selecting</span>
<span class="sd">            valid flow runs when polling for work</span>
<span class="sd">        env (Optional[dict]): Additional environment variables to set on the job</span>
<span class="sd">        image (Optional[str]): The image to use. Can also be specified via job</span>
<span class="sd">            template.</span>
<span class="sd">        job_template_path (Optional[str]): Path to a job template to use. If a local</span>
<span class="sd">            path (no file scheme, or a file/local scheme), the job template will be</span>
<span class="sd">            loaded on initialization and stored on the KubernetesRun object as the</span>
<span class="sd">            job_template field. Otherwise the job template will be loaded at runtime</span>
<span class="sd">            on the agent. Supported runtime file schemes include (s3, gcs, and agent</span>
<span class="sd">            (for paths local to the runtime agent)).</span>
<span class="sd">        job_template (Optional[str]): An in-memory job template to use.</span>
<span class="sd">        cpu_limit (Union[float, str]): The CPU limit to use for the job</span>
<span class="sd">        cpu_request (Union[float, str]): The CPU request to use for the job</span>
<span class="sd">        memory_limit (Optional[str]): The memory limit to use for the job</span>
<span class="sd">        memory_request (Optional[str]): The memory request to use for the job</span>
<span class="sd">        service_account_name (Optional[str]): A service account name to use for this</span>
<span class="sd">            job. If present, overrides any service account configured on the agent or</span>
<span class="sd">            in the job template.</span>
<span class="sd">        image_pull_secrets (Optional[list]): A list of image pull secrets to use for</span>
<span class="sd">            this job. If present, overrides any image pull secrets configured on the</span>
<span class="sd">            agent or in the job template.</span>
<span class="sd">        image_pull_policy (Optional[str]): The imagePullPolicy to use for the job.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">image</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">image_pull_secrets</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span>
    <span class="n">job_template</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span>
    <span class="n">job_template_path</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">service_account_name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>
    <span class="n">image_pull_policy</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;Always&quot;</span><span class="p">,</span> <span class="s2">&quot;IfNotPresent&quot;</span><span class="p">,</span> <span class="s2">&quot;Never&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;IfNotPresent&quot;</span>
    <span class="n">cpu_limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
    <span class="n">cpu_request</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">memory_limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">memory_request</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;memory_limit&quot;</span><span class="p">,</span> <span class="s2">&quot;memory_request&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">validate_memory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Validate w.r.t. Kubernetes resource formats: int, fixed-point number using</span>
<span class="sd">        quantity suffixes: E, P, T, G, M, k or power-of-two equivalents: Ei, Pi,</span>
<span class="sd">        Ti, Gi, Mi, Ki</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,)):</span>
            <span class="k">return</span> <span class="n">v</span>

        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,)):</span>

            <span class="n">acceptable</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="c1"># check substrings</span>
            <span class="n">inclusions</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">substring</span> <span class="k">for</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">KUBERNETES_REQUEST_SUFFIXES</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">v</span>
            <span class="p">]</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inclusions</span><span class="p">):</span>

                <span class="k">for</span> <span class="n">inclusion</span> <span class="ow">in</span> <span class="n">inclusions</span><span class="p">:</span>

                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">stripped</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">inclusion</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                        <span class="n">_</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripped</span><span class="p">)</span>
                        <span class="n">acceptable</span> <span class="o">=</span> <span class="kc">True</span>

                    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                        <span class="k">pass</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">acceptable</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Kubernetes resource request invalid: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kubernetes resource request invalid: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must provide string or int to request&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">v</span>

    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KubernetesRun</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Method for converting to Prefect RunConfig type KubernetesRun.</span>

<span class="sd">        Returns:</span>
<span class="sd">            KubernetesRun</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if job template and job template path missing, use packaged template</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_template</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_template_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">job_template</span> <span class="o">=</span> <span class="n">KUBERNETES_JOB_TEMPLATE</span>

        <span class="k">return</span> <span class="n">KubernetesRun</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.build" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">build</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Method for converting to Prefect RunConfig type KubernetesRun.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>KubernetesRun</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>KubernetesRun</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/kubernetes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KubernetesRun</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Method for converting to Prefect RunConfig type KubernetesRun.</span>

<span class="sd">    Returns:</span>
<span class="sd">        KubernetesRun</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if job template and job template path missing, use packaged template</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_template</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">job_template_path</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">job_template</span> <span class="o">=</span> <span class="n">KUBERNETES_JOB_TEMPLATE</span>

    <span class="k">return</span> <span class="n">KubernetesRun</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">dict</span><span class="p">(</span><span class="n">exclude_none</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="lume_services.services.scheduling.backends.kubernetes.KubernetesRunConfig.validate_memory" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_memory</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validate w.r.t. Kubernetes resource formats: int, fixed-point number using
quantity suffixes: E, P, T, G, M, k or power-of-two equivalents: Ei, Pi,
Ti, Gi, Mi, Ki</p>

            <details class="quote">
              <summary>Source code in <code>lume_services/services/scheduling/backends/kubernetes.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@validator</span><span class="p">(</span><span class="s2">&quot;memory_limit&quot;</span><span class="p">,</span> <span class="s2">&quot;memory_request&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">validate_memory</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Validate w.r.t. Kubernetes resource formats: int, fixed-point number using</span>
<span class="sd">    quantity suffixes: E, P, T, G, M, k or power-of-two equivalents: Ei, Pi,</span>
<span class="sd">    Ti, Gi, Mi, Ki</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,)):</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,)):</span>

        <span class="n">acceptable</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># check substrings</span>
        <span class="n">inclusions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">substring</span> <span class="k">for</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">KUBERNETES_REQUEST_SUFFIXES</span> <span class="k">if</span> <span class="n">substring</span> <span class="ow">in</span> <span class="n">v</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inclusions</span><span class="p">):</span>

            <span class="k">for</span> <span class="n">inclusion</span> <span class="ow">in</span> <span class="n">inclusions</span><span class="p">:</span>

                <span class="k">try</span><span class="p">:</span>
                    <span class="n">stripped</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">inclusion</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="n">_</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">stripped</span><span class="p">)</span>
                    <span class="n">acceptable</span> <span class="o">=</span> <span class="kc">True</span>

                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="k">pass</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">acceptable</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Kubernetes resource request invalid: </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kubernetes resource request invalid: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Must provide string or int to request&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["toc.integrate", "toc.follow", "navigation.top", "navigation.tabs"], "search": "../../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>